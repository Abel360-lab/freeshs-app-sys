{% load static %}
{% load i18n %}
<!DOCTYPE html>
<html lang="{% get_current_language as LANGUAGE_CODE %}{{ LANGUAGE_CODE }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% trans "GCX Supplier Application Portal - Official Registration" %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1a472a;
            --primary-dark: #0f2847;
            --primary-light: #2d5a3d;
            --secondary-color: #e8f0fe;
            --accent-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --text-color: #2c3e50;
            --text-muted: #6c757d;
            --border-color: #dee2e6;
            --background-light: #f8f9fa;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.16);
            --border-radius: 10px;
            --border-radius-sm: 6px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* GCX Brand Colors */
            --gcx-primary: #1a472a;
            --gcx-primary-light: #2d5a3d;
            --gcx-secondary: #f8b500;
            --gcx-accent: #ffcd3c;
            --gcx-success: #28a745;
            --gcx-dark: #1a472a;
            
            /* Light mode colors (default) */
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-tertiary: #e9ecef;
            --text-primary: #2c3e50;
            --text-secondary: #6c757d;
            --text-muted: #999999;
            --border-primary: #dee2e6;
            --border-secondary: #e9ecef;
            --card-bg: #ffffff;
            --input-bg: #ffffff;
            --header-bg: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
        }
        
        /* Dark mode color variables */
        [data-theme="dark"] {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --bg-tertiary: #404040;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --text-muted: #999999;
            --border-primary: #404040;
            --border-secondary: #4d4d4d;
            --card-bg: #2d2d2d;
            --input-bg: #404040;
            --header-bg: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.3);
        }
        
        /* Auto mode - respects system preference */
        @media (prefers-color-scheme: dark) {
            [data-theme="auto"] {
                --bg-primary: #1a1a1a;
                --bg-secondary: #2d2d2d;
                --bg-tertiary: #404040;
                --text-primary: #ffffff;
                --text-secondary: #cccccc;
                --text-muted: #999999;
                --border-primary: #404040;
                --border-secondary: #4d4d4d;
                --card-bg: #2d2d2d;
                --input-bg: #404040;
                --header-bg: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
                --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.3);
                --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.3);
                --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.3);
            }
        }
        
        /* Dark mode specific styles */
        [data-theme="dark"] .card,
        [data-theme="dark"] .application-info-bar,
        [data-theme="dark"] .step-indicator-container,
        [data-theme="dark"] .form-container,
        [data-theme="dark"] h4.form-section-title,
        [data-theme="auto"] .card,
        [data-theme="auto"] .application-info-bar,
        [data-theme="auto"] .form-container,
        [data-theme="auto"] h4.form-section-title,
        [data-theme="auto"] .form-section-title,
        [data-theme="auto"] .step-indicator-container {
            background: var(--card-bg);
            border: 1px solid var(--border-primary);
            color: #ffc107;
            
        }
        
        [data-theme="dark"] .form-control,
        [data-theme="dark"] .form-select,
        [data-theme="dark"] .form-check-input,
        [data-theme="auto"] .form-control,
        [data-theme="auto"] .form-select,
        [data-theme="auto"] .form-check-input {
            background-color: var(--input-bg);
            border-color: var(--border-primary);
            color: var(--text-primary);
        }
        
        [data-theme="dark"] .form-control:focus,
        [data-theme="dark"] .form-select:focus,
        [data-theme="auto"] .form-control:focus,
        [data-theme="auto"] .form-select:focus {
            background-color: var(--input-bg);
            border-color: var(--accent-color);
            color: var(--text-primary);
        }
        
        [data-theme="dark"] .form-label,
        [data-theme="auto"] .form-label {
            color: var(--text-secondary);
        }
        
        [data-theme="dark"] .btn-secondary,
        [data-theme="auto"] .btn-secondary {
            background-color: var(--bg-tertiary);
            border-color: var(--border-primary);
            color: var(--text-primary);
        }
        
        [data-theme="dark"] .btn-secondary:hover,
        [data-theme="auto"] .btn-secondary:hover {
            background-color: var(--border-primary);
            border-color: var(--border-secondary);
        }
        
        [data-theme="dark"] .alert-info,
        [data-theme="auto"] .alert-info {
            background-color: var(--bg-secondary);
            border-color: var(--border-primary);
            color: var(--text-primary);
        }
        

        
        [data-theme="dark"] .footer {
            background: var(--bg-primary);
            color: var(--text-secondary);
        }
        
        [data-theme="dark"] .footer-section h4 {
            color: var(--text-primary);
        }
        
        [data-theme="dark"] .footer-section p {
            color: var(--text-secondary);
        }
        
        [data-theme="dark"] .footer-links a {
            color: var(--text-secondary);
        }
        
        [data-theme="dark"] .footer-links a:hover {
            color: var(--text-primary);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding-top: 100px;
            min-height: 100vh;
            position: relative;
            transition: var(--transition);
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            /* background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%); */
            z-index: -2;
            height: 300px;
        }
        
        /* Add an overlay to ensure text readability */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            /* background: rgba(30, 58, 95, 0.7); */
            z-index: -1;
        }
        
        /* Enhanced Responsive Header */
        .fixed-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: var(--header-bg);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            border-bottom: 3px solid var(--gcx-secondary);
        }
        
        .header-content-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0.875rem 2rem;
            gap: 1rem;
        }
        
        /* Header Left */
        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
            min-width: 0;
        }
        
        .logo-wrapper {
            flex-shrink: 0;
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.12);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            padding: 0.5rem;
        }
        
        .logo-wrapper:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.18);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }
        
        .header-logo {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            object-fit: contain;
        }
        
        .header-title {
            flex: 1;
            min-width: 0;
        }
        
        .header-title-main {
            font-size: 1.375rem;
            font-weight: 700;
            color: white;
            margin: 0;
            letter-spacing: -0.02em;
            line-height: 1.2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .header-subtitle {
            font-size: 0.813rem;
            color: rgba(255, 255, 255, 0.85);
            margin: 0.25rem 0 0 0;
            font-weight: 400;
            line-height: 1.3;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* Header Right */
        .header-right {
            flex-shrink: 0;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: white;
        }
        
        .header-action-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.875rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            transition: all 0.3s ease;
            font-size: 0.875rem;
            font-weight: 500;
            text-decoration: none;
            color: white;
        }
        
        .header-action-item:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.25);
            transform: translateY(-1px);
        }
        
        .header-action-item i {
            font-size: 1rem;
            flex-shrink: 0;
        }
        
        .header-phone i {
            color: var(--gcx-secondary);
        }
        
        .header-secure i {
            color: #90EE90;
        }
        
        .header-divider {
            width: 1px;
            height: 24px;
            background: rgba(255, 255, 255, 0.2);
            flex-shrink: 0;
        }
        
        /* Language Switcher Override */
        .header-actions .language-switcher .btn:hover {
            background: transparent !important;
            border-color: rgba(255, 255, 255, 0.25) !important;
            transform: translateY(-1px);
        }
        
        .header-actions .language-switcher .btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.15);
            color: white;
            padding: 0.5rem 0.875rem;
            border-radius: 8px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            font-size: 0.875rem;
        }
        
        /* Theme Toggle Button - Django Admin Style */
        .theme-toggle {
            cursor: pointer;
            border: none;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            vertical-align: middle;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        .theme-toggle svg {
            vertical-align: middle;
            height: 16px;
            width: 16px;
            display: none;
            fill: currentColor;
        }

        html[data-theme="dark"] .theme-toggle svg.theme-icon-when-dark {
            display: block;
        }

        html[data-theme="light"] .theme-toggle svg.theme-icon-when-light {
            display: block;
        }

        /* Default to light theme if no data-theme attribute */
        html:not([data-theme]) .theme-toggle svg.theme-icon-when-light {
            display: block;
        }

        /* Visually hidden class for accessibility */
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .header-info-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius-sm);
            backdrop-filter: blur(10px);
        }
        
        .security-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0.8rem;
            background: rgba(40, 167, 69, 0.2);
            border: 1px solid rgba(40, 167, 69, 0.3);
            border-radius: 20px;
            font-size: 0.75rem;
            color: #90EE90;
            font-weight: 500;
        }
        
        /* Main Container */
        .main-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        /* Registration Header Styles */
        .registration-header {
            background: linear-gradient(135deg, rgba(26, 71, 42, 0.9) 0%, rgba(45, 90, 61, 0.9) 100%), url('/media/commodities/Untitled-1.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            color: white;
            border-radius: 16px;
            padding: 1.5rem 1.5rem;
            margin: 1rem 0;
            position: relative;
            overflow: hidden;
        }

        .registration-header::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            border-radius: 50%;
            transform: translate(50px, -50px);
        }

        .step-progress {
            background: rgba(255,255,255,0.1);
            border-radius: 50px;
            padding: 0.4rem;
            margin: 1rem 0;
        }

        .progress-track {
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 50px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--gcx-secondary) 0%, #ffcd3c 100%);
            border-radius: 50px;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .step-indicators {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 1rem 0;
            padding: 0 1rem;
        }

        .step-indicator {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            flex: 1;
            max-width: 120px;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1rem;
            position: relative;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 2;
        }

        .step-indicator.pending .step-number {
            background: rgba(255,255,255,0.2);
            color: rgba(255,255,255,0.6);
            border: 2px solid rgba(255,255,255,0.3);
        }

        .step-indicator.active .step-number {
            background: var(--gcx-secondary);
            color: var(--gcx-dark);
            border: 3px solid rgba(255,255,255,0.5);
            transform: scale(1.1);
            box-shadow: 0 0 0 4px rgba(248, 181, 0, 0.3);
        }

        .step-indicator.completed .step-number {
            background: var(--gcx-success);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .step-title {
            margin-top: 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-align: center;
            opacity: 0.9;
            transition: opacity 0.3s ease;
        }

        .step-indicator.active .step-title {
            opacity: 1;
            color: var(--gcx-secondary);
        }

        .step-connector {
            position: absolute;
            top: 20px;
            left: 40px;
            right: -60px;
            height: 3px;
            background: rgba(255,255,255,0.2);
            z-index: 1;
        }

        .step-indicator.completed .step-connector {
            background: var(--gcx-success);
        }

        .step-indicator:last-child .step-connector {
            display: none;
        }
        
        /* Form Container */
        .form-container {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            position: relative;
        }
        
        .form-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
        }
        
        .card-body {
            padding: 3rem;
        }
        
        /* Step Header Styles */
        .step-header {
            background: linear-gradient(135deg, #f8f9fa 0%, white 100%);
            padding: 2.5rem 2rem 2rem;
            /* border-bottom: 3px solid var(--gcx-accent); */
            text-align: center;
            position: relative;
        }

        .step-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, var(--gcx-primary) 0%, var(--gcx-secondary) 100%);
            border-radius: 2px;
        }

        .step-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--gcx-primary) 0%, var(--gcx-primary-light) 100%);
            color: white;
            font-size: 2rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 16px rgba(26, 71, 42, 0.3);
        }
        
        /* Form Steps */
        .form-step {
            display: none;
            animation: fadeInUp 0.5s ease;
        }
        
        .form-step.active {
            display: block;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .form-section-title {
            font-size: 1.5rem;
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .form-section-title i {
            font-size: 1.25rem;
            opacity: 0.8;
        }
        
        .form-section-subtitle {
            color: var(--text-muted);
            margin-bottom: 2rem;
            font-size: 0.95rem;
        }
        
        /* Enhanced Form Controls */
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            font-weight: 500;
            color: var(--text-color);
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            letter-spacing: 0.01em;
        }
        
        .required {
            color: var(--danger-color);
            font-weight: 600;
        }
        
        .form-control, .form-select {
            padding: 0.75rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            font-size: 0.95rem;
            transition: var(--transition);
            background: white;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(30, 58, 95, 0.1);
            outline: none;
        }
        
        .form-control.is-invalid, .form-select.is-invalid {
            border-color: var(--danger-color);
        }
        
        .form-text {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }
        
        .form-check {
            padding-left: 1.75rem;
        }
        
        .form-check-input {
            width: 1.25rem;
            height: 1.25rem;
            margin-top: 0.125rem;
            border: 2px solid var(--border-color);
            transition: var(--transition);
        }
        
        .form-check-input:checked {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .form-check-label {
            font-size: 0.95rem;
            color: var(--text-color);
            cursor: pointer;
        }

        /* Commodity Cards */
        .commodity-card {
            margin-bottom: 1rem;
        }

        .commodity-label {
            display: block;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .commodity-label:hover {
            border-color: #2196f3;
            box-shadow: 0 2px 8px rgba(33, 150, 243, 0.1);
        }

        .form-check-input:checked + .commodity-label {
            border-color: #2196f3;
            background-color: #e3f2fd;
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.2);
        }

        .commodity-content {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .commodity-image {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
            flex-shrink: 0;
        }

        .commodity-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .commodity-placeholder {
            width: 60px;
            height: 60px;
            background: #f5f5f5;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 24px;
            flex-shrink: 0;
        }

        .commodity-info {
            flex: 1;
        }

        .commodity-name {
            margin: 0 0 0.5rem 0;
            font-weight: 600;
            color: #333;
        }

        .commodity-description {
            margin: 0 0 0.5rem 0;
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }

        .commodity-info .badge {
            font-size: 0.75rem;
        }

        /* Form Grid Responsive Adjustments */
        @media (max-width: 768px) {
            .row {
                margin-left: -0.5rem;
                margin-right: -0.5rem;
            }
            
            .col-md-6 {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            .col-md-4 {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            .col-md-3 {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
                width: 100%;
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            .commodity-content {
                flex-direction: column;
                text-align: center;
                gap: 0.5rem;
            }

            .commodity-image,
            .commodity-placeholder {
                width: 80px;
                height: 80px;
            }
            
            .commodity-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .commodity-card {
                padding: 1rem;
            }
        }
        
        @media (max-width: 576px) {
            .row {
                margin-left: -0.25rem;
                margin-right: -0.25rem;
            }
            
            .col-md-6,
            .col-md-4,
            .col-md-3 {
                padding-left: 0.25rem;
                padding-right: 0.25rem;
            }
            
            .commodity-grid {
                gap: 0.75rem;
            }
            
            .commodity-card {
                padding: 0.75rem;
            }
            
            .commodity-image,
            .commodity-placeholder {
                width: 60px;
                height: 60px;
            }
        }
        
        /* File Upload Enhancement */
        .file-upload-area {
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius);
            padding: 2rem;
            text-align: center;
            background: var(--background-light);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
        }
        
        .file-upload-area:hover {
            border-color: var(--primary-color);
            background: rgba(30, 58, 95, 0.02);
        }
        
        .file-upload-area.dragover {
            border-color: var(--accent-color);
            background: rgba(40, 167, 69, 0.05);
        }
        
        .file-upload-icon {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }
        
        .file-upload-text {
            color: var(--text-color);
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .file-upload-hint {
            color: var(--text-muted);
            font-size: 0.875rem;
        }
        
        .file-input-hidden {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            opacity: 0;
            cursor: pointer;
        }
        
        /* Enhanced Terms Container */
        .terms-container {
            background: linear-gradient(135deg, var(--background-light) 0%, white 100%);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin: 2rem 0;
            max-height: 450px;
            overflow-y: auto;
            position: relative;
        }
        
        .terms-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .terms-container::-webkit-scrollbar-track {
            background: var(--background-light);
            border-radius: 4px;
        }
        
        .terms-container::-webkit-scrollbar-thumb {
            background: var(--primary-light);
            border-radius: 4px;
        }
        
        .terms-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: 1.5rem;
            position: sticky;
            top: -2rem;
            background: white;
            z-index: 10;
        }
        
        .terms-icon {
            width: 50px;
            height: 50px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .terms-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .terms-content {
            line-height: 1.8;
            color: var(--text-color);
        }
        
        .terms-content h5 {
            color: var(--primary-color);
            font-weight: 600;
            margin: 1.5rem 0 1rem;
            font-size: 1.125rem;
        }
        
        .terms-content ol, .terms-content ul {
            padding-left: 1.5rem;
        }
        
        .terms-content li {
            margin-bottom: 0.75rem;
        }
        
        /* Enhanced Cards */
        .info-card {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            overflow: hidden;
            margin-bottom: 1.5rem;
            transition: var(--transition);
        }
        
        .info-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }
        
        .info-card-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: white;
            padding: 1rem 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .info-card-header.secondary {
            background: linear-gradient(135deg, var(--text-muted) 0%, #8b939c 100%);
        }
        
        .info-card-body {
            padding: 1.5rem;
        }
        
        /* Navigation Buttons */
        .form-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 2px solid var(--border-color);
        }
        
        .btn {
            padding: 0.75rem 2rem;
            border-radius: var(--border-radius-sm);
            font-weight: 500;
            font-size: 0.95rem;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .btn-secondary {
            background: white;
            color: var(--text-color);
            border: 2px solid var(--border-color);
        }
        
        .btn-secondary:hover {
            background: var(--background-light);
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--accent-color) 0%, #22c55e 100%);
            color: white;
            padding: 1rem 3rem;
            font-size: 1rem;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        /* Alert Styles */
        .alert {
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .alert-icon {
            font-size: 1.25rem;
            flex-shrink: 0;
        }
        
        .alert-info {
            background: rgba(13, 110, 253, 0.1);
            border: 1px solid rgba(13, 110, 253, 0.2);
            color: var(--primary-color);
        }
        
        .alert-warning {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.2);
            color: #856404;
        }
        
        .alert-success {
            background: rgba(40, 167, 69, 0.1);
            border: 1px solid rgba(40, 167, 69, 0.2);
            color: #155724;
        }
        
        /* Compact Enhanced Footer */
        .footer {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: white;
            padding: 2.5rem 0 0;
            margin-top: 4rem;
            position: relative;
            overflow: hidden;
        }
        
        .footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.05)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.03)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            position: relative;
            z-index: 2;
        }
        
        /* Footer Brand */
        .footer-brand h4 {
            font-size: 1.25rem;
            font-weight: 700;
            color: white;
            margin: 0;
        }

        .footer-logo-img {
            max-width: 80px;
            height: auto;
            opacity: 0.95;
            transition: all 0.3s ease;
        }

        .footer-logo-img:hover {
            opacity: 1;
            transform: scale(1.05);
        }

        .footer-tagline {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.6rem;
            line-height: 1.5;
        }

        /* Footer Heading */
        .footer-heading {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: white;
            position: relative;
            padding-bottom: 0.5rem;
        }
        
        .footer-heading::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 30px;
            height: 2px;
            background: var(--gcx-secondary);
        }
        
        .text-lg-start .footer-heading::after {
            left: 50%;
            transform: translateX(-50%);
        }
        
        @media (min-width: 992px) {
            .text-lg-start .footer-heading::after {
                left: 0;
                transform: none;
            }
        }

        /* Social Links Compact */
        .social-links {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
        }
        
        @media (min-width: 992px) {
            .social-links {
                justify-content: flex-start;
            }
        }
        
        .social-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-radius: 50%;
            text-decoration: none;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .social-link:hover {
            background: var(--gcx-secondary);
            color: var(--gcx-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(248, 181, 0, 0.3);
        }
        
        .social-link i {
            font-size: 0.875rem;
        }
        
        /* Contact Compact */
        .contact-compact {
            display: flex;
            flex-direction: column;
            gap: 0.625rem;
        }
        
        .contact-compact-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            color: rgba(255, 255, 255, 0.85);
            font-size: 0.875rem;
            line-height: 1.5;
        }
        
        .contact-compact-item i {
            color: var(--gcx-secondary);
            font-size: 0.875rem;
            margin-top: 0.125rem;
            flex-shrink: 0;
            width: 16px;
        }
        
        /* Footer Badges Compact */
        .footer-badges-compact {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .badge-compact {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            padding: 0.375rem 0.75rem;
            border-radius: 16px;
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            width: fit-content;
        }
        
        .badge-compact:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateX(3px);
        }
        
        .badge-compact i {
            color: var(--gcx-secondary);
            font-size: 0.75rem;
        }
        
        /* Footer Legal Compact */
        .footer-legal-compact {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }
        
        .footer-legal-compact a {
            color: rgba(255, 255, 255, 0.75);
            text-decoration: none;
            font-size: 0.813rem;
            transition: all 0.3s ease;
            position: relative;
            padding-bottom: 2px;
        }
        
        .footer-legal-compact a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 1px;
            background: var(--gcx-secondary);
            transition: width 0.3s ease;
        }
        
        .footer-legal-compact a:hover {
            color: var(--gcx-secondary);
        }
        
        .footer-legal-compact a:hover::after {
            width: 100%;
        }
        
        /* Footer Bottom Compact */
        .footer-bottom-compact {
            margin-top: 1.5rem;
            padding: 1rem 0;
            border-top: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        .footer-bottom-compact p {
            color: rgba(255, 255, 255, 0.75);
            font-size: 0.813rem;
            line-height: 1.5;
        }
        
        .government-badge {
            color: var(--gcx-secondary);
            font-weight: 600;
        }
        
        /* Responsive Design */
        
        /* Large Tablets and Small Desktops */
        @media (max-width: 1024px) {
            .container {
                padding: 0 1rem;
            }
            
            .card-body {
                padding: 2rem;
            }
            
            .header-content {
                padding: 0 1rem;
            }
            
            .registration-header {
                padding: 1rem;
            }
            
            .step-indicators {
                flex-wrap: wrap;
                gap: 0.5rem;
            }
        }
        
        /* Tablets */
        @media (max-width: 768px) {
            body {
                padding-top: 76px;
                font-size: 14px;
            }
            
            .container {
                padding: 0 0.75rem;
            }
            
            .header-content-wrapper {
                padding: 0.75rem 1rem;
            }
            
            .logo-wrapper {
                width: 48px;
                height: 48px;
            }
            
            .header-title-main {
                font-size: 1.125rem;
            }
            
            .header-subtitle {
                font-size: 0.75rem;
            }
            
            .header-actions {
                gap: 0.625rem;
            }
            
            .header-action-text {
                display: none;
            }
            
            .header-action-item {
                padding: 0.5rem;
                min-width: 36px;
                justify-content: center;
            }
            
            .header-divider {
                display: none;
            }
            
            .theme-toggle {
                width: 36px;
                height: 36px;
            }
            
            .registration-header {
                display: none;
            }
            
            .step-indicators {
                padding: 0 0.5rem;
                overflow-x: auto;
                justify-content: flex-start;
                gap: 0.5rem;
            }
            
            .step-indicator {
                min-width: 60px;
                flex-shrink: 0;
            }
            
            /* Mobile-specific header improvements */
            .fixed-header {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                z-index: 1000;
                background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                backdrop-filter: blur(10px);
            }
            
            /* Ensure proper spacing for mobile content */
            .main-container {
                margin-top: 0;
            }
            
            .application-info-bar {
                flex-direction: column;
                align-items: center;
                text-align: center;
                gap: 0.5rem;
                padding: 0.75rem;
                margin-top: 1rem; /* Add margin to ensure it's not hidden */
                margin-bottom: 1rem; /* Ensure proper spacing below */
                background: white;
                border-radius: 8px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                position: relative;
                z-index: 10; /* Ensure it's above other content */
            }
            
            .application-info-bar span {
                font-size: 0.8rem;
            }
            
            .step-indicator {
                padding: 0 0.5rem;
                overflow-x: auto;
                justify-content: flex-start;
            }
            
            .step-item {
                min-width: 60px;
                flex-shrink: 0;
            }
            
            .step-number {
                width: 32px;
                height: 32px;
                font-size: 0.875rem;
            }
            
            .step-label {
                font-size: 0.7rem;
                margin-top: 0.25rem;
            }
            
            .card {
                margin-bottom: 1rem;
                border-radius: 8px;
            }
            
            .card-body {
                padding: 1.25rem;
            }
            
            .form-group {
                margin-bottom: 1rem;
            }
            
            .form-label {
                font-size: 0.875rem;
                margin-bottom: 0.5rem;
            }
            
            .form-control, .form-select, .form-check-input {
                font-size: 0.875rem;
                padding: 0.75rem;
                border-radius: 6px;
            }
            
            .btn {
                font-size: 0.875rem;
                padding: 0.75rem 1.5rem;
                border-radius: 6px;
            }
            
            .form-navigation {
                flex-direction: column-reverse;
                gap: 0.75rem;
                margin-top: 1.5rem;
            }
            
            .form-navigation .btn {
                width: 100%;
                justify-content: center;
                padding: 1rem;
            }
            
            .footer {
                padding: 2rem 0 0;
                margin-top: 3rem;
            }

            .footer-content {
                padding: 0 1rem;
            }

            .footer-logo-img {
                max-width: 70px;
            }
            
            .footer-brand h4 {
                font-size: 1.125rem;
            }
            
            .footer-heading {
                font-size: 0.938rem;
            }
            
            .contact-compact-item {
                font-size: 0.813rem;
            }
        }
        
        /* Mobile Devices */
        @media (max-width: 576px) {
            body {
                padding-top: 70px;
                font-size: 13px;
            }
            
            .container {
                padding: 0 0.5rem;
            }
            
            .header-content-wrapper {
                padding: 0.625rem 0.75rem;
                gap: 0.5rem;
            }
            
            .logo-wrapper {
                width: 44px;
                height: 44px;
            }
            
            .header-title-main {
                font-size: 0.938rem;
            }
            
            .header-subtitle {
                font-size: 0.688rem;
            }
            
            .header-actions {
                gap: 0.5rem;
            }
            
            .header-phone {
                display: none;
            }
            
            .header-action-item {
                padding: 0.438rem;
                min-width: 32px;
            }
            
            .header-action-item i {
                font-size: 0.875rem;
            }
            
            .theme-toggle {
                width: 32px;
                height: 32px;
            }
            
            .theme-toggle svg {
                width: 14px;
                height: 14px;
            }
            
            .application-info-bar {
                padding: 0.5rem;
                margin-top: 0.75rem; /* Ensure proper spacing */
            }
            
            .application-info-bar span {
                font-size: 0.75rem;
            }
            
            .step-indicator {
                padding: 0 0.25rem;
                gap: 0.25rem;
            }
            
            .step-item {
                min-width: 50px;
            }
            
            .step-number {
                width: 28px;
                height: 28px;
                font-size: 0.75rem;
            }
            
            .step-label {
                font-size: 0.65rem;
                line-height: 1.2;
            }
            
            .card-body {
                padding: 1rem;
            }
            
            .form-group {
                margin-bottom: 0.875rem;
            }
            
            .form-label {
                font-size: 0.8rem;
                margin-bottom: 0.375rem;
            }
            
            .form-control, .form-select, .form-check-input {
                font-size: 0.8rem;
                padding: 0.625rem;
            }
            
            .btn {
                font-size: 0.8rem;
                padding: 0.875rem 1.25rem;
            }
            
            .form-navigation {
                gap: 0.5rem;
                margin-top: 1.25rem;
            }
            
            .form-navigation .btn {
                padding: 0.875rem;
            }
            
            .footer {
                padding: 1.5rem 0 0;
                margin-top: 2rem;
            }

            .footer-content {
                padding: 0 0.75rem;
            }

            .footer-logo-img {
                max-width: 60px;
            }
            
            .footer-brand h4 {
                font-size: 1rem;
            }
            
            .footer-tagline {
                font-size: 0.813rem;
            }
            
            .footer-heading {
                font-size: 0.875rem;
            }
            
            .social-link {
                width: 32px;
                height: 32px;
            }
            
            .social-link i {
                font-size: 0.75rem;
            }
            
            .contact-compact-item {
                font-size: 0.75rem;
                gap: 0.5rem;
            }
            
            .contact-compact-item i {
                font-size: 0.75rem;
            }
            
            .badge-compact {
                font-size: 0.688rem;
                padding: 0.313rem 0.625rem;
            }
            
            .footer-legal-compact a {
                font-size: 0.75rem;
            }
            
            .footer-bottom-compact {
                margin-top: 1rem;
                padding: 0.75rem 0;
            }
            
            .footer-bottom-compact p {
                font-size: 0.75rem;
            }
        }
        
        /* Extra Small Devices */
        @media (max-width: 375px) {
            body {
                padding-top: 64px;
            }
            
            .container {
                padding: 0 0.375rem;
            }
            
            .header-content-wrapper {
                padding: 0.5rem;
                gap: 0.375rem;
            }
            
            .logo-wrapper {
                width: 40px;
                height: 40px;
            }
            
            .header-title-main {
                font-size: 0.875rem;
            }
            
            .header-subtitle {
                display: none;
            }
            
            .header-actions {
                gap: 0.375rem;
            }
            
            .header-secure .header-action-text {
                display: none;
            }
            
            .theme-toggle {
                width: 30px;
                height: 30px;
            }
            
            .step-number {
                width: 24px;
                height: 24px;
                font-size: 0.7rem;
            }
            
            .step-label {
                font-size: 0.6rem;
            }
            
            .card-body {
                padding: 0.875rem;
            }
            
            .form-control, .form-select, .form-check-input {
                font-size: 0.75rem;
                padding: 0.5rem;
            }
            
            .btn {
                font-size: 0.75rem;
                padding: 0.75rem 1rem;
            }
            
            .footer-logo-img {
                max-width: 80px;
            }
        }
        
        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Mobile Touch Enhancements */
        @media (max-width: 768px) {
            /* Improve touch targets */
            .btn, .form-control, .form-select, .form-check-input {
                min-height: 44px; /* iOS recommended touch target size */
            }
            
            .step-number {
                min-width: 44px;
                min-height: 44px;
            }
            
            /* Improve scrolling */
            .step-indicator {
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }
            
            .step-indicator::-webkit-scrollbar {
                display: none;
            }
            
            /* Better form spacing */
            .form-group {
                margin-bottom: 1.25rem;
            }
            
            /* Improve checkbox and radio button spacing */
            .form-check {
                margin-bottom: 1rem;
                padding-left: 2rem;
            }
            
            .form-check-input {
                width: 1.25rem;
                height: 1.25rem;
                margin-top: 0.125rem;
                margin-left: -2rem;
            }
            
            .form-check-label {
                font-size: 0.875rem;
                line-height: 1.4;
            }
        }
        
        @media (max-width: 576px) {
            /* Extra small mobile optimizations */
            .btn, .form-control, .form-select, .form-check-input {
                min-height: 48px; /* Larger touch targets for small screens */
            }
            
            .step-number {
                min-width: 48px;
                min-height: 48px;
            }
            
            .form-check {
                padding-left: 2.25rem;
            }
            
            .form-check-input {
                width: 1.5rem;
                height: 1.5rem;
                margin-left: -2.25rem;
            }
        }
        
        /* Landscape mobile optimization */
        @media (max-width: 768px) and (orientation: landscape) {
            body {
                padding-top: 60px; /* Reduced for landscape */
            }
            
            .fixed-header {
                height: 60px; /* Compact for landscape */
            }
            
            .header-content {
                padding: 0.375rem 0.75rem;
                height: 100%;
            }
            
            .logo img {
                height: 32px; /* Slightly smaller for landscape */
            }
            
            .app-title h1 {
                font-size: 0.95rem; /* Compact for landscape */
                margin-bottom: 0;
                line-height: 1.1;
            }
            
            .app-title p {
                font-size: 0.65rem; /* Compact subtitle */
                margin: 0;
                line-height: 1;
            }
            
            .application-info-bar {
                padding: 0.5rem;
                margin-top: 0.5rem; /* Minimal margin for landscape */
            }
            
            .step-indicator {
                padding: 0.25rem;
            }
            
            .step-item {
                min-width: 45px;
            }
            
            .step-number {
                width: 28px;
                height: 28px;
                font-size: 0.75rem;
            }
            
            .step-label {
                font-size: 0.6rem;
            }
            
            .card-body {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Enhanced Responsive Header -->
    <header class="fixed-header">
        <div class="header-content-wrapper">
            <div class="header-left">
                <div class="logo-wrapper">
                    <img src="/media/logo/logo1.png" alt="GCX Logo" class="header-logo">
                </div>
                <div class="header-title">
                    <h1 class="header-title-main">{% if site_settings %}{{ site_settings.company_name }}{% else %}{% trans "Ghana Commodity Exchange" %}{% endif %}</h1>
                    <p class="header-subtitle">{% trans "Official Supplier Registration Portal" %}</p>
                </div>
            </div>
            <div class="header-right">
                <div class="header-actions">
                    <a href="tel:{% if site_settings %}{{ site_settings.primary_phone|cut:' '|cut:'+' }}{% else %}233241234567{% endif %}" class="header-action-item header-phone">
                        <i class="fas fa-headset"></i>
                        <span class="header-action-text">{% if site_settings %}{{ site_settings.primary_phone }}{% else %}+233 24 123 4567{% endif %}</span>
                    </a>
                    <div class="header-action-item header-secure">
                        <i class="fas fa-shield-check"></i>
                        <span class="header-action-text">Secure</span>
                    </div>
                    <div class="header-divider"></div>
                    {% include 'language_switcher.html' %}
                    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
                        <span class="visually-hidden">Toggle theme</span>
                        <svg aria-hidden="true" class="theme-icon-when-light">
                            <use xlink:href="#icon-moon" />
                        </svg>
                        <svg aria-hidden="true" class="theme-icon-when-dark">
                            <use xlink:href="#icon-sun" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- SVG Icons for Theme Toggle -->
    <svg style="display: none;">
        <defs>
            <symbol id="icon-moon" viewBox="0 0 24 24">
                <path d="M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.4 6.35,17.41C9.37,20.43 14,20.54 17.33,17.97Z"/>
            </symbol>
            <symbol id="icon-sun" viewBox="0 0 24 24">
                <path d="M12,18C8.69,18 6,15.31 6,12C6,8.69 8.69,6 12,6C15.31,6 18,8.69 18,12C18,15.31 15.31,18 12,18M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8M12,1L13.09,3.26L16,2L14.74,4.91L19,5L16.74,7.91L19,9L16,8L13.09,10.74L12,13L10.91,10.74L8,12L9.26,9.09L5,9L7.26,6.09L5,5L8,6L10.91,3.26L12,1Z"/>
            </symbol>
        </defs>
    </svg>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Registration Header -->
        <div class="registration-header fade-in">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h2 class="mb-2" style="font-size: 1.5rem;">
                        <i class="fas fa-user-plus me-2"></i>
                        GCX Supplier Registration
                    </h2>
                    <p class="mb-0 opacity-90" style="font-size: 0.9rem;">Complete all steps to register as an approved supplier with Ghana Commodity Exchange</p>
                </div>
                <div class="col-md-4 text-md-end">
                    <div class="step-progress">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="small opacity-75">Progress</span>
                            <span class="fw-bold" id="progress-percentage">12%</span>
                        </div>
                        <div class="progress-track">
                            <div class="progress-fill" data-progress="12" style="width: 12%;"></div>
                        </div>
                    </div>
                    <div class="mt-2">
                        <small class="opacity-75">Reference:</small><br>
                        <span class="fw-bold" id="ref-number">GCX-2025-000000</span>
                    </div>
                </div>
            </div>
            
            <!-- Step Indicators -->
            <div class="step-indicators">
                <div class="step-indicator active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-title">Terms</div>
                    <div class="step-connector"></div>
                </div>
                <div class="step-indicator pending" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-title">Business</div>
                    <div class="step-connector"></div>
                </div>
                <div class="step-indicator pending" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-title">Commodities</div>
                    <div class="step-connector"></div>
                </div>
                <div class="step-indicator pending" data-step="4">
                    <div class="step-number">4</div>
                    <div class="step-title">Team</div>
                    <div class="step-connector"></div>
                </div>
                <div class="step-indicator pending" data-step="5">
                    <div class="step-number">5</div>
                    <div class="step-title">Next of Kin</div>
                    <div class="step-connector"></div>
                </div>
                <div class="step-indicator pending" data-step="6">
                    <div class="step-number">6</div>
                    <div class="step-title">Banking</div>
                    <div class="step-connector"></div>
                </div>
                <div class="step-indicator pending" data-step="7">
                    <div class="step-number">7</div>
                    <div class="step-title">Documents</div>
                    <div class="step-connector"></div>
                </div>
                <div class="step-indicator pending" data-step="8">
                    <div class="step-number">8</div>
                    <div class="step-title">Review</div>
                </div>
            </div>
        </div>

        <!-- Form Container -->
        <div class="form-container">
            <div class="card-body">
                <!-- Step Header -->
                <div class="step-header">
                    <div class="step-icon">
                        <i class="fas fa-clipboard-list" id="step-icon"></i>
                    </div>
                    <h2 class="text-primary mb-2" id="step-title">Step 1: Terms and Conditions</h2>
                    <p class="text-muted mb-0" id="step-description">Please read and accept the terms and conditions to continue</p>
                </div>

                <form id="application-form" method="post" enctype="multipart/form-data" action="{% url 'applications:application-submit' %}" novalidate>
                    {% csrf_token %}
                    
                    <!-- Step 1: Terms and Conditions -->
                    <div class="form-step active" id="form-step-1">
                        <h4 class="form-section-title">
                            <i class="fas fa-gavel"></i>
                            Terms and Conditions
                        </h4>
                        <p class="form-section-subtitle">Please carefully review and accept the terms and conditions before proceeding with your application.</p>
                        
                        <div class="terms-container">
                            <div class="terms-header">
                                <div class="terms-icon">
                                    <i class="fas fa-file-contract"></i>
                                </div>
                                <div>
                                    <div class="terms-title">SUPPLIER REGISTRATION TERMS</div>
                                    <small class="text-muted">Ghana Commodity Exchange - Official Document</small>
                                </div>
                            </div>
                            <div class="terms-content">
                                <div class="alert alert-warning">
                                    <i class="fas fa-exclamation-triangle alert-icon"></i>
                                    <div>
                                        <strong>Important Notice:</strong> Completion of this form and payment of registration fees does NOT guarantee a contract to supply food items to senior high schools and TVETS nationwide.
                                    </div>
                                </div>
                                
                                <h5>Application Requirements</h5>
                                <ol>
                                    <li>Complete the form, attach all required documents along with the application and submit electronically to the Head of Special Projects Unit : specialprojects@gcx.com.gh</li>
                                    <li>Pay a non-refundable Application fee of Ghc 1,000.00 into the Ghana Commodity Exchange Revenue Account (Ecobank, Head Office Branch - 1441004833179)</li>
                                    <li>Pay a non-refundable Registration fee of Ghc 5,000.00 for supplies valued below Ghc 5million or Ghc 10,000.00 for supplies valued above Ghc 5 million as applicable.</li>
                                </ol>
                                
                                <h5>Required Documentation</h5>
                                <p>The following documents must be submitted with your application (certified copies acceptable):</p>
                                <ul>
                                    <li><strong>Business Registration Documents</strong> - Certificate of Incorporation, Form 3, and Form C</li>
                                    <li><strong>Valid VAT Registration Certificate</strong> - Must be current and in good standing</li>
                                    <li><strong>Valid PPA Certificate</strong> - Public Procurement Authority registration</li>
                                    <li><strong>Valid Tax Clearance Certificate</strong> - Including TIN number</li>
                                    <li><strong>Proof of Office Location</strong> - Utility bills, rent agreement, or property documents</li>
                                    <li><strong>Directors' Identification</strong> - Valid ID of MD, CEO, or Partners (Ghana Card, Passport, or Voter's ID)</li>
                                    <li><strong>GCX Registration Proof</strong> - Evidence of registration with Ghana Commodity Exchange</li>
                                    <li><strong>Team Member Documentation</strong> - Valid ID of team member with relevant experience</li>
                                    <li><strong>FDA Certificate</strong> - Required for processed food suppliers (Tom Brown, Palm Oil, etc.)</li>
                                </ul>
                                
                                <h5>Processing Timeline</h5>
                                <p>Applications are typically processed within 10-15 business days. Incomplete applications may experience delays.</p>
                                
                                <h5>Data Protection</h5>
                                <p>All information provided will be treated confidentially and in accordance with Ghana's Data Protection Act 2012 (Act 843).</p>
                            </div>
                        </div>
                        
                        <div class="form-check mt-4">
                            <input class="form-check-input" type="checkbox" id="terms_accepted" name="terms_accepted" required>
                            <label class="form-check-label" for="terms_accepted">
                                I have thoroughly read, understood, and agree to comply with all terms and conditions stated above. <span class="required">*</span>
                            </label>
                        </div>
                    </div>

                    <!-- Step 2: Business Information -->
                    <div class="form-step" id="form-step-2">
                        <h4 class="form-section-title">
                            <i class="fas fa-building"></i>
                            Business Information
                        </h4>
                        <p class="form-section-subtitle">Provide accurate details about your business entity</p>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="business_name" class="form-label">Registered Business Name <span class="required">*</span></label>
                                    <input type="text" class="form-control" id="business_name" name="business_name" required>
                                    <small class="form-text">As it appears on your registration certificate</small>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="business_type" class="form-label">Business Type <span class="required">*</span></label>
                                    <select class="form-select" id="business_type" name="business_type" required>
                                        <option value="">Select Business Type</option>
                                        <option value="sole">Sole Proprietorship</option>
                                        <option value="partnership">Partnership</option>
                                        <option value="limited">Limited Liability Company</option>
                                        <option value="corporation">Corporation</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="registration_number" class="form-label">Registration Number</label>
                                    <input type="text" class="form-control" id="registration_number" name="registration_number">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="tin_number" class="form-label">TIN Number</label>
                                    <input type="text" class="form-control" id="tin_number" name="tin_number">
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="email" class="form-label">Official Email Address <span class="required">*</span></label>
                                    <input type="email" class="form-control" id="email" name="email" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="telephone" class="form-label">Primary Contact Number <span class="required">*</span></label>
                                    <input type="tel" class="form-control" id="telephone" name="telephone" placeholder="0243123456 or +233243123456" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="physical_address" class="form-label">Physical Business Address <span class="required">*</span></label>
                            <textarea class="form-control" id="physical_address" name="physical_address" rows="2" required></textarea>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="city" class="form-label">City/Town <span class="required">*</span></label>
                                    <input type="text" class="form-control" id="city" name="city" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="region" class="form-label">Region <span class="required">*</span></label>
                                    <select class="form-select" id="region" name="region" required>
                                        <option value="">Select Region</option>
                                        {% for region in regions %}
                                        <option value="{{ region.id }}">{{ region.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="postal_code" class="form-label">Digital Address/GPS</label>
                                    <input type="text" class="form-control" id="postal_code" name="postal_code">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="warehouse_location" class="form-label">Warehouse/Storage Location <span class="required">*</span></label>
                            <textarea class="form-control" id="warehouse_location" name="warehouse_location" rows="2" required></textarea>
                            <small class="form-text">Provide complete address of your storage facility</small>
                        </div>
                    </div>

                    <!-- Step 3: Commodities -->
                    <div class="form-step" id="form-step-3">
                        <h4 class="form-section-title">
                            <i class="fas fa-seedling"></i>
                            Commodities to Supply
                        </h4>
                        <p class="form-section-subtitle">Select all commodities your business can reliably supply</p>
                        
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle alert-icon"></i>
                            <div>
                                Select from our approved commodity list below. You must be able to provide consistent quality and quantity for selected items.
                            </div>
                        </div>
                        
                        <div class="row">
                            {% for commodity in commodities %}
                                {% if forloop.counter0|divisibleby:3 %}
                                    {% if not forloop.first %}</div>{% endif %}
                                    <div class="col-md-4">
                                {% endif %}
                                <div class="commodity-card">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="{{ commodity.id }}" id="commodity_{{ commodity.id }}" name="commodities">
                                        <label class="form-check-label commodity-label" for="commodity_{{ commodity.id }}">
                                            <div class="commodity-content">
                                                {% if commodity.image %}
                                                    <div class="commodity-image">
                                                        <img src="{{ commodity.image.url }}" alt="{{ commodity.name }}" class="img-fluid">
                                                    </div>
                                                {% else %}
                                                    <div class="commodity-placeholder">
                                                        <i class="fas fa-seedling"></i>
                                                    </div>
                                                {% endif %}
                                                <div class="commodity-info">
                                                    <h6 class="commodity-name">{{ commodity.name }}</h6>
                                                    {% if commodity.description %}
                                                        <p class="commodity-description">{{ commodity.description }}</p>
                                                    {% endif %}
                                                    {% if commodity.is_processed_food %}
                                                        <span class="badge bg-warning">Processed Food</span>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                                {% if forloop.last %}</div>{% endif %}
                            {% endfor %}
                        </div>
                        
                        <!-- <div class="mt-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="other_commodities_checkbox" name="other_commodities_checkbox">
                                <label class="form-check-label" for="other_commodities_checkbox">
                                    <strong>Other Commodities</strong> - I supply additional commodities not listed above
                                </label>
                            </div>
                        </div> -->
                        
                        <!-- <div class="info-card mt-3" id="other_commodities_section" style="display: none;">
                            <div class="info-card-header">
                                <i class="fas fa-plus-circle"></i>
                                Other Commodities
                            </div>
                            <div class="info-card-body">
                                <div class="form-group">
                                    <label for="other_commodities" class="form-label">Specify Other Commodities</label>
                                    <textarea class="form-control" id="other_commodities" name="other_commodities" rows="3" placeholder="List additional commodities, separated by commas"></textarea>
                                    <small class="form-text">Example: Shea nuts, Cocoa beans, Coffee, etc.</small>
                                </div>
                            </div>
                        </div> -->
                    </div>

                    <!-- Step 4: Team Member -->
                    <div class="form-step" id="form-step-4">
                        <h4 class="form-section-title">
                            <i class="fas fa-user-tie"></i>
                            Key Team Member
                        </h4>
                        <p class="form-section-subtitle">Provide details of the team member with food supply and distribution experience</p>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="team_member_name" class="form-label">Full Name <span class="required">*</span></label>
                                    <input type="text" class="form-control" id="team_member_name" name="team_member_name" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="team_member_position" class="form-label">Position/Role <span class="required">*</span></label>
                                    <input type="text" class="form-control" id="team_member_position" name="team_member_position" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="team_member_telephone" class="form-label">Contact Number <span class="required">*</span></label>
                                    <input type="tel" class="form-control" id="team_member_telephone" name="team_member_telephone" placeholder="0243123456 or +233243123456" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="team_member_email" class="form-label">Email Address</label>
                                    <input type="email" class="form-control" id="team_member_email" name="team_member_email">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="team_member_address" class="form-label">Residential Address <span class="required">*</span></label>
                            <textarea class="form-control" id="team_member_address" name="team_member_address" rows="2" required></textarea>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="team_member_city" class="form-label">City/Town <span class="required">*</span></label>
                                    <input type="text" class="form-control" id="team_member_city" name="team_member_city" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="team_member_region" class="form-label">Region <span class="required">*</span></label>
                                    <select class="form-select" id="team_member_region" name="team_member_region" required>
                                        <option value="">Select Region</option>
                                        {% for region in regions %}
                                        <option value="{{ region.id }}">{{ region.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="team_member_years" class="form-label">Years of Experience</label>
                                    <input type="number" class="form-control" id="team_member_years" name="team_member_years" min="0">
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="team_member_id_type" class="form-label">ID Type <span class="required">*</span></label>
                                    <select class="form-select" id="team_member_id_type" name="team_member_id_type" required>
                                        <option value="">Select ID Type</option>
                                        <option value="GHANA_CARD">Ghana Card</option>
                                        <option value="PASSPORT">Passport</option>
                                        <option value="VOTER_ID">Voter ID</option>
                                        <option value="DRIVER_LICENSE">Driver's License</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="team_member_id_number" class="form-label">ID Number <span class="required">*</span></label>
                                    <input type="text" class="form-control" id="team_member_id_number" name="team_member_id_number" required>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 5: Next of Kin -->
                    <div class="form-step" id="form-step-5">
                        <h4 class="form-section-title">
                            <i class="fas fa-users"></i>
                            Next of Kin Information
                        </h4>
                        <p class="form-section-subtitle">Emergency contact information</p>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="next_of_kin_name" class="form-label">Full Name <span class="required">*</span></label>
                                    <input type="text" class="form-control" id="next_of_kin_name" name="next_of_kin_name" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="next_of_kin_relationship" class="form-label">Relationship <span class="required">*</span></label>
                                    <select class="form-select" id="next_of_kin_relationship" name="next_of_kin_relationship" required>
                                        <option value="">Select Relationship</option>
                                        <option value="spouse">Spouse</option>
                                        <option value="parent">Parent</option>
                                        <option value="child">Child</option>
                                        <option value="sibling">Sibling</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="next_of_kin_address" class="form-label">Address <span class="required">*</span></label>
                            <textarea class="form-control" id="next_of_kin_address" name="next_of_kin_address" rows="2" required></textarea>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="next_of_kin_mobile" class="form-label">Mobile Number <span class="required">*</span></label>
                                    <input type="tel" class="form-control" id="next_of_kin_mobile" name="next_of_kin_mobile" placeholder="0243123456 or +233243123456" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="next_of_kin_email" class="form-label">Email Address</label>
                                    <input type="email" class="form-control" id="next_of_kin_email" name="next_of_kin_email">
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="next_of_kin_id_type" class="form-label">ID Type</label>
                                    <select class="form-select" id="next_of_kin_id_type" name="next_of_kin_id_type">
                                        <option value="">Select ID Type</option>
                                        <option value="GHANA_CARD">Ghana Card</option>
                                        <option value="PASSPORT">Passport</option>
                                        <option value="VOTER_ID">Voter ID</option>
                                        <option value="DRIVER_LICENSE">Driver's License</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="next_of_kin_id_number" class="form-label">ID Number</label>
                                    <input type="text" class="form-control" id="next_of_kin_id_number" name="next_of_kin_id_number">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 6: Bank Account -->
                    <div class="form-step" id="form-step-6">
                        <h4 class="form-section-title">
                            <i class="fas fa-university"></i>
                            Banking Information
                        </h4>
                        <p class="form-section-subtitle">Provide your bank account details for payment processing</p>
                        
                        <!-- Primary Bank Account -->
                        <div class="info-card">
                            <div class="info-card-header">
                                <i class="fas fa-star"></i>
                                Primary Bank Account
                            </div>
                            <div class="info-card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="primary_bank_name" class="form-label">Bank Name <span class="required">*</span></label>
                                            <select class="form-select" id="primary_bank_name" name="primary_bank_name" required>
                                                <option value="">Select Bank</option>
                                                <option value="GCB">GCB Bank</option>
                                                <option value="CBG">Consolidated Bank Ghana</option>
                                                <option value="ADB">Agricultural Development Bank</option>
                                                <option value="NIB">National Investment Bank</option>
                                                <option value="STANBIC">Stanbic Bank</option>
                                                <option value="STANDARD">Standard Chartered</option>
                                                <option value="ABSA">Absa Bank</option>
                                                <option value="ECOBANK">Ecobank</option>
                                                <option value="FIDELITY">Fidelity Bank</option>
                                                <option value="ZENITH">Zenith Bank</option>
                                                <option value="CAL">CAL Bank</option>
                                                <option value="UBA">UBA</option>
                                                <option value="ACCESS">Access Bank</option>
                                                <option value="OTHER">Other</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="primary_bank_branch" class="form-label">Branch <span class="required">*</span></label>
                                            <input type="text" class="form-control" id="primary_bank_branch" name="primary_bank_branch" required>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="primary_account_name" class="form-label">Account Name <span class="required">*</span></label>
                                            <input type="text" class="form-control" id="primary_account_name" name="primary_account_name" required>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="primary_account_number" class="form-label">Account Number <span class="required">*</span></label>
                                            <input type="text" class="form-control" id="primary_account_number" name="primary_account_number" required>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Secondary Bank Account -->
                        <div class="info-card mt-3">
                            <div class="info-card-header secondary">
                                <i class="fas fa-piggy-bank"></i>
                                Secondary Bank Account (Optional)
                            </div>
                            <div class="info-card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="secondary_bank_name" class="form-label">Bank Name</label>
                                            <select class="form-select" id="secondary_bank_name" name="secondary_bank_name">
                                                <option value="">Select Bank</option>
                                                <option value="GCB">GCB Bank</option>
                                                <option value="CBG">Consolidated Bank Ghana</option>
                                                <option value="ADB">Agricultural Development Bank</option>
                                                <option value="NIB">National Investment Bank</option>
                                                <option value="STANBIC">Stanbic Bank</option>
                                                <option value="STANDARD">Standard Chartered</option>
                                                <option value="ABSA">Absa Bank</option>
                                                <option value="ECOBANK">Ecobank</option>
                                                <option value="FIDELITY">Fidelity Bank</option>
                                                <option value="ZENITH">Zenith Bank</option>
                                                <option value="CAL">CAL Bank</option>
                                                <option value="UBA">UBA</option>
                                                <option value="ACCESS">Access Bank</option>
                                                <option value="OTHER">Other</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="secondary_bank_branch" class="form-label">Branch</label>
                                            <input type="text" class="form-control" id="secondary_bank_branch" name="secondary_bank_branch">
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="secondary_account_name" class="form-label">Account Name</label>
                                            <input type="text" class="form-control" id="secondary_account_name" name="secondary_account_name">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="secondary_account_number" class="form-label">Account Number</label>
                                            <input type="text" class="form-control" id="secondary_account_number" name="secondary_account_number">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 7: Document Upload -->
                    <div class="form-step" id="form-step-7">
                        <h4 class="form-section-title">
                            <i class="fas fa-folder-open"></i>
                            Document Upload
                        </h4>
                        <p class="form-section-subtitle">Upload supporting documents. You can submit some documents now and upload the rest later. Files should be in PDF, JPG, or PNG format (max 5MB each)</p>
                        
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle alert-icon"></i>
                            <div>
                                <strong>Flexible Upload:</strong> You can submit your application with partial documents and upload the remaining ones later via your user account.
                            </div>
                        </div>
                        
                        <div class="row">
                            {% for requirement in document_requirements %}
                            <div class="col-md-6 mb-4">
                                    <label class="form-label">
                                        {{ requirement.label }}
                                        {% if requirement.is_required %}<span class="required">*</span>{% endif %}
                                    </label>
                                <div class="file-upload-area">
                                    <input type="file" 
                                           class="file-input-hidden document-upload" 
                                           id="{{ requirement.code|lower }}" 
                                           name="{{ requirement.code|lower }}" 
                                           accept=".pdf,.jpg,.jpeg,.png"
                                           data-required="{{ requirement.is_required|yesno:'true,false' }}"
                                           {% if requirement.is_required %}required{% endif %}>
                                    <i class="fas fa-cloud-upload-alt file-upload-icon"></i>
                                    <div class="file-upload-text">Click to upload or drag and drop</div>
                                    <div class="file-upload-hint">{{ requirement.description }}</div>
                                    {% if requirement.condition_note %}
                                    <div class="file-upload-condition">
                                        <small class="text-muted">
                                            <i class="fas fa-info-circle"></i> {{ requirement.condition_note }}
                                        </small>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Step 8: Review & Declaration -->
                    <div class="form-step" id="form-step-8">
                        <h4 class="form-section-title">
                            <i class="fas fa-check-double"></i>
                            Review & Declaration
                        </h4>
                        <p class="form-section-subtitle">Please review your application details before submission</p>
                        
                        <div class="alert alert-success">
                            <i class="fas fa-check-circle alert-icon"></i>
                            <div>
                                <strong>Almost Done!</strong> Please review your information and provide your declaration below.
                            </div>
                        </div>
                        
                        <!-- Application Summary will be dynamically inserted here -->
                        <div id="application-summary" class="mb-4">
                            <!-- Summary content will be generated by JavaScript -->
                        </div>
                        
                        <div class="info-card">
                            <div class="info-card-header">
                                <i class="fas fa-signature"></i>
                                Declaration & Authorization
                            </div>
                            <div class="info-card-body">
                                <div class="form-check mt-3">
                                    <input class="form-check-input" type="checkbox" id="declaration_agreed" name="declaration_agreed" required>
                                    <label class="form-check-label" for="declaration_agreed">
                                        I hereby declare that the details furnished above are true and correct to the best of my knowledge and belief. I undertake to inform you of any changes therein immediately. In case any of the above information is found to be false or untrue or misleading or misrepresenting I am aware that I may be held liable for it.  <span class="required">*</span>
                                    </label>
                                </div>
                                
                                <div class="form-check mt-2">
                                    <input class="form-check-input" type="checkbox" id="data_consent" name="data_consent" required>
                                    <label class="form-check-label" for="data_consent">
                                        I consent to the processing of my personal data in accordance with the Data Protection Act 2012 (Act 843) for the purposes of this application. <span class="required">*</span>
                                    </label>
                                </div>
                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="signer_name" class="form-label">Authorized Signatory Name <span class="required">*</span></label>
                                            <input type="text" class="form-control" id="signer_name" name="signer_name" required>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="signer_designation" class="form-label">Designation/Title <span class="required">*</span></label>
                                            <input type="text" class="form-control" id="signer_designation" name="signer_designation" required>
                                        </div>
                                    </div>
                                </div>
                                
                                
                            </div>
                        </div>
                    </div>

                    <!-- Navigation Buttons -->
                    <div class="form-navigation">
                        <button type="button" class="btn btn-secondary" id="prev-btn" style="display: none;">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button type="button" class="btn btn-primary" id="next-btn">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                        <button type="submit" class="btn btn-success" id="submit-btn" style="display: none;">
                            <i class="fas fa-paper-plane"></i> Submit Application
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Compact Enhanced Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="row align-items-start">
                <div class="col-lg-4 col-md-12 mb-3 text-center text-lg-start">
                    <div class="footer-brand">
                        <img src="/media/logo/logo_transparent_white.png" alt="GCX Logo" class="footer-logo-img mb-2">
                        <h4 class="mb-2">{% if site_settings %}{{ site_settings.company_name }}{% else %}Ghana Commodity Exchange{% endif %}</h4>
                        <p class="footer-tagline mb-3">{% if site_settings %}{{ site_settings.tagline }}{% else %}Connecting People, Connecting Markets & Providing Opportunities{% endif %}</p>
                        {% if not site_settings or site_settings.show_social_media %}
                        <div class="social-links">
                            {% if not site_settings or site_settings.facebook_url %}
                            <a href="{% if site_settings %}{{ site_settings.facebook_url }}{% else %}#{% endif %}" class="social-link" aria-label="Facebook" {% if site_settings and site_settings.facebook_url %}target="_blank"{% endif %}><i class="fab fa-facebook-f"></i></a>
                            {% endif %}
                            {% if not site_settings or site_settings.twitter_url %}
                            <a href="{% if site_settings %}{{ site_settings.twitter_url }}{% else %}#{% endif %}" class="social-link social-link-x" aria-label="X (Twitter)" {% if site_settings and site_settings.twitter_url %}target="_blank"{% endif %}>
                                <svg viewBox="0 0 24 24" fill="currentColor" style="width: 14px; height: 14px;">
                                    <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                                </svg>
                            </a>
                            {% endif %}
                            {% if not site_settings or site_settings.linkedin_url %}
                            <a href="{% if site_settings %}{{ site_settings.linkedin_url }}{% else %}#{% endif %}" class="social-link" aria-label="LinkedIn" {% if site_settings and site_settings.linkedin_url %}target="_blank"{% endif %}><i class="fab fa-linkedin-in"></i></a>
                            {% endif %}
                            {% if not site_settings or site_settings.instagram_url %}
                            <a href="{% if site_settings %}{{ site_settings.instagram_url }}{% else %}#{% endif %}" class="social-link" aria-label="Instagram" {% if site_settings and site_settings.instagram_url %}target="_blank"{% endif %}><i class="fab fa-instagram"></i></a>
                            {% endif %}
                            {% if not site_settings or site_settings.youtube_url %}
                            <a href="{% if site_settings %}{{ site_settings.youtube_url }}{% else %}#{% endif %}" class="social-link" aria-label="YouTube" {% if site_settings and site_settings.youtube_url %}target="_blank"{% endif %}><i class="fab fa-youtube"></i></a>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                </div>
                
                <div class="col-lg-4 col-md-6 mb-3">
                    <h5 class="footer-heading">Contact Us</h5>
                    <div class="contact-compact">
                        <div class="contact-compact-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>{% if site_settings %}{{ site_settings.get_full_address }}{% else %}2nd Floor, Africa Trade House, Ridge, Accra{% endif %}</span>
                        </div>
                        <div class="contact-compact-item">
                            <i class="fas fa-phone"></i>
                            <span>{% if site_settings %}{{ site_settings.primary_phone }}{% if site_settings.secondary_phone %} | {{ site_settings.secondary_phone }}{% endif %}{% else %}+233 24 123 4567 | +233 30 123 4567{% endif %}</span>
                        </div>
                        <div class="contact-compact-item">
                            <i class="fas fa-envelope"></i>
                            <span>{% if site_settings %}{{ site_settings.support_email }}{% else %}itsupport@gcx.com.gh{% endif %} | {% if site_settings %}{{ site_settings.info_email }}{% else %}itsupport@gcx.com.gh{% endif %}</span>
                        </div>
                        <div class="contact-compact-item">
                            <i class="fas fa-clock"></i>
                            <span>{% if site_settings %}{{ site_settings.get_business_hours_compact }}{% else %}Mon-Fri: 8AM-5PM | Sat: 9AM-1PM{% endif %}</span>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-4 col-md-6 mb-3">
                    <h5 class="footer-heading">Trust & Security</h5>
                    <div class="footer-badges-compact mb-3">
                        <span class="badge-compact"><i class="fas fa-shield-check"></i> SSL Secured</span>
                        <span class="badge-compact"><i class="fas fa-lock"></i> Data Protected</span>
                        <!-- <span class="badge-compact"><i class="fas fa-certificate"></i> ISO Certified</span> -->
                    </div>
                    <div class="footer-legal-compact">
                        <a href="#">Privacy</a>
                        <a href="#">Terms</a>
                        <a href="#">Data Protection</a>
                        <a href="#">Compliance</a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom-compact">
                <div class="row align-items-center">
                    <div class="col-md-6 text-center text-md-start">
                        <p class="mb-0">&copy; 2025 Ghana Commodity Exchange. All rights reserved. | <span class="government-badge">IT Department</span></p>
                    </div>
                    <div class="col-md-6 text-center text-md-end">
                        <p class="mb-0">Supplier Registration Portal {% if site_settings %}{{ site_settings.portal_version }}{% else %}v1.0{% endif %}</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let currentStep = 1;
        const totalSteps = 8;
        const estimatedTimes = [2, 3, 2, 2, 2, 2, 3, 1]; // Minutes per step

        // Generate reference number
        function generateRefNumber() {
            const ref = Math.floor(100000 + Math.random() * 900000);
            const refElement = document.getElementById('ref-number');
            if (refElement) {
                refElement.textContent = `GCX-2025-${ref}`;
            }
        }


        // Update step indicator
        function updateStepIndicator() {
            const progressPercent = ((currentStep - 1) / (totalSteps - 1)) * 100;
            
            // Update progress bar
            const progressFill = document.querySelector('.progress-fill');
            const progressPercentage = document.getElementById('progress-percentage');
            if (progressFill) {
                progressFill.style.width = progressPercent + '%';
                progressFill.setAttribute('data-progress', Math.round(progressPercent));
            }
            if (progressPercentage) {
                progressPercentage.textContent = Math.round(progressPercent) + '%';
            }
            
            // Update step indicators
            for (let i = 1; i <= totalSteps; i++) {
                const stepIndicator = document.querySelector(`[data-step="${i}"]`);
                if (stepIndicator) {
                    if (i < currentStep) {
                        stepIndicator.classList.remove('active', 'pending');
                        stepIndicator.classList.add('completed');
                    } else if (i === currentStep) {
                        stepIndicator.classList.remove('pending', 'completed');
                        stepIndicator.classList.add('active');
                    } else {
                        stepIndicator.classList.remove('active', 'completed');
                        stepIndicator.classList.add('pending');
                    }
                }
            }
            
            // Update step header
            updateStepHeader();
        }
        
        // Update step header
        function updateStepHeader() {
            const stepTitles = [
                'Terms and Conditions',
                'Business Information', 
                'Commodities to Supply',
                'Team Members',
                'Next of Kin',
                'Banking Information',
                'Document Upload',
                'Review and Submit'
            ];
            
            const stepDescriptions = [
                'Please read and accept the terms and conditions to continue',
                'Provide your business details and registration information',
                'Select the commodities you wish to supply to GCX',
                'Add your team members and their information',
                'Provide next of kin contact details',
                'Enter your banking information for payments',
                'Upload required documents and certificates',
                'Review all information before submitting your application'
            ];
            
            const stepIcons = [
                'fas fa-clipboard-list',
                'fas fa-building',
                'fas fa-boxes',
                'fas fa-users',
                'fas fa-user-friends',
                'fas fa-university',
                'fas fa-file-upload',
                'fas fa-check-circle'
            ];
            
            const stepTitle = document.getElementById('step-title');
            const stepDescription = document.getElementById('step-description');
            const stepIcon = document.getElementById('step-icon');
            
            if (stepTitle) {
                stepTitle.textContent = `Step ${currentStep}: ${stepTitles[currentStep - 1]}`;
            }
            if (stepDescription) {
                stepDescription.textContent = stepDescriptions[currentStep - 1];
            }
            if (stepIcon) {
                stepIcon.className = stepIcons[currentStep - 1];
            }
        }

        // Show step
        function showStep(step) {
            document.querySelectorAll('.form-step').forEach(s => s.classList.remove('active'));
            document.getElementById(`form-step-${step}`).classList.add('active');
            updateStepIndicator();

            // Update navigation buttons
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const submitBtn = document.getElementById('submit-btn');

            if (step === 1) {
                prevBtn.style.display = 'none';
            } else {
                prevBtn.style.display = 'inline-flex';
            }

            if (step === totalSteps) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'inline-flex';
                generateApplicationSummary();
            } else {
                nextBtn.style.display = 'inline-flex';
                submitBtn.style.display = 'none';
            }
            
            // Scroll to top
            window.scrollTo({ top: 100, behavior: 'smooth' });
        }

        // Validate step
        function validateStep(step) {
            const stepElement = document.getElementById(`form-step-${step}`);
            const requiredFields = stepElement.querySelectorAll('[required]:not(.document-upload)');
            
            let isValid = true;
            
            for (let field of requiredFields) {
                if (field.type === 'checkbox') {
                    if (!field.checked) {
                        field.classList.add('is-invalid');
                        isValid = false;
                    } else {
                        field.classList.remove('is-invalid');
                    }
                } else {
                    if (!field.value.trim()) {
                        field.classList.add('is-invalid');
                        isValid = false;
                    } else {
                        field.classList.remove('is-invalid');
                    }
                }
            }
            
            // Special validation for FDA certificate (only if processed foods are selected and field is required)
            if (step === 7) { // Document upload step
                const fdaField = document.getElementById('fda_cert_processed_food');
                if (fdaField && fdaField.required && !fdaField.files.length) {
                    const fdaArea = fdaField.closest('.file-upload-area');
                    if (fdaArea) {
                        fdaArea.style.borderColor = 'var(--danger-color)';
                        isValid = false;
                    }
                } else if (fdaField && !fdaField.required) {
                    // If FDA field is optional, reset any error styling
                    const fdaArea = fdaField.closest('.file-upload-area');
                    if (fdaArea) {
                        fdaArea.style.borderColor = '';
                    }
                }
            }
            
            // Special validation for commodities
            if (step === 3) {
                const commodityCheckboxes = stepElement.querySelectorAll('input[name="commodities"]');
                const otherCheckbox = document.getElementById('other_commodities_checkbox');
                const commodityChecked = Array.from(commodityCheckboxes).some(cb => cb.checked);
                
                if (!commodityChecked && !otherCheckbox.checked) {
                    isValid = false;
                    showNotification('Please select at least one commodity', 'warning');
                }
            }
            
            return isValid;
        }
        
        // Validate all steps before submission
        function validateAllSteps() {
            let isValid = true;
            
            for (let i = 1; i <= 8; i++) {
                const stepElement = document.getElementById(`form-step-${i}`);
                const requiredFields = stepElement.querySelectorAll('[required]:not(.document-upload)');
                
                for (let field of requiredFields) {
                    if (field.type === 'checkbox') {
                        if (!field.checked) {
                            field.classList.add('is-invalid');
                            isValid = false;
                        } else {
                            field.classList.remove('is-invalid');
                        }
                    } else if (field.type === 'email') {
                        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                        if (!field.value.trim() || !emailRegex.test(field.value.trim())) {
                            field.classList.add('is-invalid');
                            isValid = false;
                        } else {
                            field.classList.remove('is-invalid');
                        }
                    } else if (field.type === 'tel') {
                        // Accept: +233XXXXXXXXX, 233XXXXXXXXX, 0243XXXXXX, or 243XXXXXX
                        const phoneRegex = /^(\+?233|0?233|0)[1-9]\d{8}$/;
                        if (!field.value.trim() || !phoneRegex.test(field.value.trim())) {
                            field.classList.add('is-invalid');
                            isValid = false;
                        } else {
                            field.classList.remove('is-invalid');
                        }
                    } else {
                        if (!field.value.trim()) {
                            field.classList.add('is-invalid');
                            isValid = false;
                        } else {
                            field.classList.remove('is-invalid');
                        }
                    }
                }
                
                // Special validation for commodities
                if (i === 3) {
                    const commodityCheckboxes = document.querySelectorAll('input[name="commodities"]:checked');
                    const otherCheckbox = document.getElementById('other_commodities_checkbox');
                    const otherText = document.getElementById('other_commodities');
                    
                    if (commodityCheckboxes.length === 0 && (!otherCheckbox.checked || !otherText.value.trim())) {
                        showNotification('Please select at least one commodity or specify other commodities', 'warning');
                        isValid = false;
                    }
                }
            }
            
            return isValid;
        }

        // Generate application summary
        function generateApplicationSummary() {
            const summary = document.getElementById('application-summary');
            const businessName = document.getElementById('business_name').value || 'Not provided';
            const email = document.getElementById('email').value || 'Not provided';
            const region = document.getElementById('region').options[document.getElementById('region').selectedIndex]?.text || 'Not selected';
            
            summary.innerHTML = `
                <div class="info-card">
                    <div class="info-card-header">
                        <i class="fas fa-clipboard-list"></i>
                        Application Summary
                    </div>
                    <div class="info-card-body">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <strong>Business Name:</strong><br>${businessName}
                            </div>
                            <div class="col-md-6 mb-3">
                                <strong>Email:</strong><br>${email}
                            </div>
                            <div class="col-md-6 mb-3">
                                <strong>Region:</strong><br>${region}
                            </div>
                            <div class="col-md-6 mb-3">
                                <strong>Reference Number:</strong><br>${document.getElementById('ref-number')?.textContent || 'GCX-2025-000000'}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.style.position = 'fixed';
            alertDiv.style.top = '120px';
            alertDiv.style.right = '20px';
            alertDiv.style.zIndex = '9999';
            alertDiv.style.maxWidth = '400px';
            alertDiv.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'} alert-icon"></i>
                <span>${message}</span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            document.body.appendChild(alertDiv);
            
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

        // Event Listeners
        const nextBtn = document.getElementById('next-btn');
        if (nextBtn) {
            nextBtn.addEventListener('click', function() {
                if (validateStep(currentStep)) {
                    currentStep++;
                    showStep(currentStep);
                } else {
                    showNotification('Please fill in all required fields', 'warning');
                }
            });
        }

        const prevBtn = document.getElementById('prev-btn');
        if (prevBtn) {
            prevBtn.addEventListener('click', function() {
                currentStep--;
                showStep(currentStep);
            });
        }

        // Other commodities toggle
        const otherCommoditiesCheckbox = document.getElementById('other_commodities_checkbox');
        if (otherCommoditiesCheckbox) {
            otherCommoditiesCheckbox.addEventListener('change', function() {
                const otherSection = document.getElementById('other_commodities_section');
                if (otherSection) {
                    otherSection.style.display = this.checked ? 'block' : 'none';
                }
                // Toggle FDA certificate field when other commodities section is shown/hidden
                toggleFDACertificateField();
            });
        }
        
        // Commodity selection handlers
        document.querySelectorAll('input[name="commodities"]').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                toggleFDACertificateField();
            });
        });
        
        // Other commodities text input handler
        const otherCommoditiesInput = document.getElementById('other_commodities');
        if (otherCommoditiesInput) {
            otherCommoditiesInput.addEventListener('input', function() {
                toggleFDACertificateField();
            });
        }

        // Processed food commodities that require FDA certificate
        const processedFoodCommodities = ['Tom Brown', 'Palm Oil'];
        
        // Function to check if processed foods are selected
        function hasProcessedFoods() {
            const commodityCheckboxes = document.querySelectorAll('input[name="commodities"]:checked');
            const otherCommoditiesElement = document.getElementById('other_commodities');
            const otherCommodities = otherCommoditiesElement ? otherCommoditiesElement.value.toLowerCase() : '';
            
            // Check selected commodities
            for (let checkbox of commodityCheckboxes) {
                const label = checkbox.nextElementSibling.textContent.trim();
                if (processedFoodCommodities.includes(label)) {
                    return true;
                }
            }
            
            // Check other commodities text
            for (let food of processedFoodCommodities) {
                if (otherCommodities.includes(food.toLowerCase())) {
                    return true;
                }
            }
            
            return false;
        }
        
        // Function to toggle FDA certificate field requirement
        function toggleFDACertificateField() {
            const fdaField = document.getElementById('fda_cert_processed_food');
            const fdaArea = fdaField ? fdaField.closest('.file-upload-area').parentElement : null;
            
            if (fdaArea) {
                const hasProcessed = hasProcessedFoods();
                
                // Always show the field, but make it required only if processed foods are selected
                fdaArea.style.display = 'block';
                
                // Update required attribute and visual indicators
                if (fdaField) {
                    fdaField.required = hasProcessed;
                    fdaField.setAttribute('data-required', hasProcessed.toString());
                    
                    // Update the label to show if it's required or optional
                    const label = fdaArea.querySelector('.form-label');
                    if (label) {
                        const requiredSpan = label.querySelector('.required');
                        if (hasProcessed) {
                            if (!requiredSpan) {
                                const span = document.createElement('span');
                                span.className = 'required';
                                span.textContent = ' *';
                                label.appendChild(span);
                            }
                        } else {
                            if (requiredSpan) {
                                requiredSpan.remove();
                            }
                        }
                    }
                    
                    // Update the hint text to indicate if it's optional
                    const hint = fdaArea.querySelector('.file-upload-hint');
                    if (hint) {
                        if (hasProcessed) {
                            hint.textContent = 'FDA Certificate for Processed Food (Required)';
                        } else {
                            hint.textContent = 'FDA Certificate for Processed Food (Optional - only if you supply processed foods)';
                        }
                    }
                    
                    // Update the condition note
                    const conditionNote = fdaArea.querySelector('.file-upload-condition small');
                    if (conditionNote) {
                        if (hasProcessed) {
                            conditionNote.innerHTML = '<i class="fas fa-info-circle"></i> Required when supplying processed foods';
                        } else {
                            conditionNote.innerHTML = '<i class="fas fa-info-circle"></i> Optional - only required if you supply processed foods (Tom Brown, Palm Oil, etc.)';
                        }
                    }
                }
            }
        }
        
        // File upload enhancements
        document.querySelectorAll('.file-upload-area').forEach(area => {
            const input = area.querySelector('.file-input-hidden');
            
            // Handle click on the upload area
            area.addEventListener('click', function(e) {
                console.log('DEBUG: File upload area clicked', e.target);
                // Don't trigger if clicking directly on the input
                if (e.target === input) return;
                
                // Trigger the file input
                console.log('DEBUG: Triggering file input click');
                input.click();
            });
            
            area.addEventListener('dragover', (e) => {
                console.log('DEBUG: Drag over detected');
                e.preventDefault();
                e.stopPropagation();
                area.classList.add('dragover');
            });
            
            area.addEventListener('dragenter', (e) => {
                console.log('DEBUG: Drag enter detected');
                e.preventDefault();
                e.stopPropagation();
                area.classList.add('dragover');
            });
            
            area.addEventListener('dragleave', (e) => {
                console.log('DEBUG: Drag leave detected');
                e.preventDefault();
                e.stopPropagation();
                area.classList.remove('dragover');
            });
            
            area.addEventListener('drop', (e) => {
                console.log('DEBUG: File dropped', e.dataTransfer.files.length);
                e.preventDefault();
                e.stopPropagation();
                area.classList.remove('dragover');
                
                if (e.dataTransfer.files.length) {
                    console.log('DEBUG: Setting files on input', e.dataTransfer.files[0].name);
                    input.files = e.dataTransfer.files;
                    updateFileDisplay(area, e.dataTransfer.files[0]);
                }
            });
            
            input.addEventListener('change', (e) => {
                if (e.target.files.length) {
                    updateFileDisplay(area, e.target.files[0]);
                }
            });
        });

        function updateFileDisplay(area, file) {
            console.log('DEBUG: updateFileDisplay called with file:', file.name);
            const text = area.querySelector('.file-upload-text');
            const hint = area.querySelector('.file-upload-hint');
            const icon = area.querySelector('.file-upload-icon');
            
            if (text) text.textContent = file.name;
            if (hint) hint.textContent = `${(file.size / 1024 / 1024).toFixed(2)} MB`;
            if (icon) {
                icon.classList.remove('fa-cloud-upload-alt');
                icon.classList.add('fa-check-circle');
            }
            area.style.borderColor = 'var(--accent-color)';
            console.log('DEBUG: File display updated successfully');
        }

        // Real-time validation for all form fields
        function addRealTimeValidation() {
            // Email fields
            const emailFields = document.querySelectorAll('input[type="email"]');
            emailFields.forEach(field => {
                field.addEventListener('input', function() {
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (this.value.trim() && !emailRegex.test(this.value.trim())) {
                        this.classList.add('is-invalid');
                        this.classList.remove('is-valid');
                    } else if (this.value.trim()) {
                        this.classList.remove('is-invalid');
                        this.classList.add('is-valid');
                    } else {
                        this.classList.remove('is-invalid', 'is-valid');
                    }
                });
                
                field.addEventListener('blur', function() {
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (this.value.trim() && !emailRegex.test(this.value.trim())) {
                        this.classList.add('is-invalid');
                        this.classList.remove('is-valid');
                    } else if (this.value.trim()) {
                        this.classList.remove('is-invalid');
                        this.classList.add('is-valid');
                    }
                });
            });
            
            // Phone fields
            const phoneFields = document.querySelectorAll('input[type="tel"]');
            phoneFields.forEach(field => {
                field.addEventListener('input', function() {
                    // Accept: +233XXXXXXXXX, 233XXXXXXXXX, 0243XXXXXX, or 243XXXXXX
                    const phoneRegex = /^(\+?233|0?233|0)[1-9]\d{8}$/;
                    if (this.value.trim() && !phoneRegex.test(this.value.trim())) {
                        this.classList.add('is-invalid');
                        this.classList.remove('is-valid');
                    } else if (this.value.trim()) {
                        this.classList.remove('is-invalid');
                        this.classList.add('is-valid');
                    } else {
                        this.classList.remove('is-invalid', 'is-valid');
                    }
                });
                
                field.addEventListener('blur', function() {
                    // Accept: +233XXXXXXXXX, 233XXXXXXXXX, 0243XXXXXX, or 243XXXXXX
                    const phoneRegex = /^(\+?233|0?233|0)[1-9]\d{8}$/;
                    if (this.value.trim() && !phoneRegex.test(this.value.trim())) {
                        this.classList.add('is-invalid');
                        this.classList.remove('is-valid');
                    } else if (this.value.trim()) {
                        this.classList.remove('is-invalid');
                        this.classList.add('is-valid');
                    }
                });
            });
            
            // Text input fields (required)
            const textFields = document.querySelectorAll('input[type="text"][required], input[type="number"][required], textarea[required]');
            textFields.forEach(field => {
                field.addEventListener('input', function() {
                    if (this.value.trim()) {
                        this.classList.remove('is-invalid');
                        this.classList.add('is-valid');
                    } else {
                        this.classList.remove('is-valid');
                        this.classList.add('is-invalid');
                    }
                });
                
                field.addEventListener('blur', function() {
                    if (this.value.trim()) {
                        this.classList.remove('is-invalid');
                        this.classList.add('is-valid');
                    } else {
                        this.classList.remove('is-valid');
                        this.classList.add('is-invalid');
                    }
                });
            });
            
            // Select fields (required)
            const selectFields = document.querySelectorAll('select[required]');
            selectFields.forEach(field => {
                field.addEventListener('change', function() {
                    if (this.value && this.value !== '') {
                        this.classList.remove('is-invalid');
                        this.classList.add('is-valid');
                    } else {
                        this.classList.remove('is-valid');
                        this.classList.add('is-invalid');
                    }
                });
            });
            
            // Checkbox fields (required)
            const checkboxFields = document.querySelectorAll('input[type="checkbox"][required]');
            checkboxFields.forEach(field => {
                field.addEventListener('change', function() {
                    if (this.checked) {
                        this.classList.remove('is-invalid');
                        this.classList.add('is-valid');
                    } else {
                        this.classList.remove('is-valid');
                        this.classList.add('is-invalid');
                    }
                });
            });
        }
        
        // Initialize real-time validation
        addRealTimeValidation();

        // Save draft functionality (removed since we replaced the application info bar)
        // document.querySelector('.save-draft-btn').addEventListener('click', function() {
        //     showNotification('Draft saved successfully! You can continue later.', 'success');
        // });

        // Form submission
        const applicationForm = document.getElementById('application-form');
        if (applicationForm) {
            applicationForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!validateAllSteps()) {
                showNotification('Please complete all required fields in all steps', 'warning');
                
                // Find the step containing the first invalid field
                const firstInvalid = document.querySelector('.is-invalid');
                if (firstInvalid) {
                    // Find which step contains this invalid field
                    let invalidStep = 1;
                    for (let i = 1; i <= 8; i++) {
                        const stepElement = document.getElementById(`form-step-${i}`);
                        if (stepElement && stepElement.contains(firstInvalid)) {
                            invalidStep = i;
                            break;
                        }
                    }
                    
                    // Navigate to the step with the invalid field
                    goToStep(invalidStep);
                    
                    // Scroll to the invalid field
                    setTimeout(() => {
                        firstInvalid.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        firstInvalid.focus();
                    }, 100);
                }
                
                return;
            }
            
            const submitBtn = document.getElementById('submit-btn');
            const originalContent = submitBtn.innerHTML;
            submitBtn.innerHTML = '<span class="spinner"></span> Submitting...';
            submitBtn.disabled = true;
            
            // Create FormData object
            let formData = new FormData(this);
            
            // Manually collect commodity checkboxes to ensure multiple values are sent
            const commodityCheckboxes = document.querySelectorAll('input[name="commodities"]:checked');
            console.log('DEBUG: Found commodity checkboxes:', commodityCheckboxes.length);
            console.log('DEBUG: Selected commodities:', Array.from(commodityCheckboxes).map(cb => cb.value));
            
            // Debug: Check original FormData
            console.log('DEBUG: Original FormData commodities entries:');
            for (let [key, value] of formData.entries()) {
                if (key === 'commodities') {
                    console.log(`  ${key}: ${value}`);
                }
            }
            
            // Create a new FormData object to avoid issues with delete/append
            const newFormData = new FormData();
            
            // Copy all existing form data except commodities
            for (let [key, value] of formData.entries()) {
                if (key !== 'commodities') {
                    newFormData.append(key, value);
                }
            }
            
            // Add each selected commodity
            commodityCheckboxes.forEach(checkbox => {
                newFormData.append('commodities', checkbox.value);
                console.log('DEBUG: Added commodity to newFormData:', checkbox.value);
            });
            
            // Debug: Verify all commodities were added
            console.log('DEBUG: Total commodities added:', commodityCheckboxes.length);
            
            // Debug: Check what's in newFormData before replacing
            console.log('DEBUG: newFormData commodities entries:');
            for (let [key, value] of newFormData.entries()) {
                if (key === 'commodities') {
                    console.log(`  ${key}: ${value}`);
                }
            }
            
            // Replace the original formData
            formData = newFormData;
            
            // Debug: Check what's in formData
            console.log('DEBUG: Final FormData commodities entries:');
            for (let [key, value] of formData.entries()) {
                if (key === 'commodities') {
                    console.log(`  ${key}: ${value}`);
                }
            }
            
            // Email field is used as-is without modification
            
            // Submit to backend
            fetch('{% url "applications:application-submit" %}', {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                }
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    return response.json().then(errorData => {
                        throw new Error(JSON.stringify(errorData));
                    });
                }
            })
            .then(data => {
                showNotification('Application submitted successfully! Check your email for confirmation.', 'success');
                
                // Redirect to success page with tracking code
                setTimeout(() => {
                    window.location.href = '{% url "applications:application-success" %}?tracking_code=' + data.tracking_code;
                }, 2000);
            })
            .catch(error => {
                console.error('Error:', error);
                submitBtn.innerHTML = originalContent;
                submitBtn.disabled = false;
                
                // Try to parse error message
                let errorMessage = 'An error occurred while submitting your application. Please try again.';
                try {
                    const errorData = JSON.parse(error.message);
                    if (errorData && typeof errorData === 'object') {
                        // Handle field-specific errors
                        const fieldErrors = [];
                        for (const [field, message] of Object.entries(errorData)) {
                            if (field === 'email') {
                                fieldErrors.push(`Email: ${message}`);
                            } else if (field === 'commodity_ids') {
                                fieldErrors.push(`Commodities: ${message}`);
                            } else if (field === 'declaration_agreed') {
                                fieldErrors.push(`Declaration: ${message}`);
                            } else {
                                fieldErrors.push(`${field}: ${message}`);
                            }
                        }
                        if (fieldErrors.length > 0) {
                            errorMessage = fieldErrors.join('. ');
                        }
                    } else if (typeof errorData === 'string') {
                        errorMessage = errorData;
                    }
                } catch (parseError) {
                    // If parsing fails, use the original error message
                    console.error('Error parsing error response:', parseError);
                }
                
                showNotification(errorMessage, 'error');
            });
        });
        }

        // Initialize
        generateRefNumber();
        showStep(currentStep);
        
        // Initialize FDA certificate field visibility
        if (document.getElementById('fda_cert_processed_food')) {
            toggleFDACertificateField();
        }
        
        // Django Admin Style Theme Toggle
        document.addEventListener("DOMContentLoaded", function () {
            const themeToggle = document.getElementById("theme-toggle");

            function setTheme(theme) {
                document.documentElement.setAttribute("data-theme", theme);
                localStorage.setItem("theme", theme);
            }

            function toggleTheme() {
                const currentTheme = document.documentElement.getAttribute("data-theme");
                const newTheme = currentTheme === "light" ? "dark" : "light";
                setTheme(newTheme);
            }

            if (themeToggle) {
                themeToggle.addEventListener("click", toggleTheme);
            }

            // Initialize theme on page load
            const savedTheme = localStorage.getItem("theme") || "light";
            setTheme(savedTheme);
        });
    </script>
</body>
</html>